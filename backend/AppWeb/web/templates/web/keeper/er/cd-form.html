<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta name="description" content="" />
    <meta name="author" content="" />

    <title>ER - Completando Registro</title>

    <!-- Custom fonts for this template-->
    <link
      href="https://startbootstrap.github.io/startbootstrap-sb-admin-2/vendor/fontawesome-free/css/all.min.css"
      rel="stylesheet"
      type="text/css"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
      rel="stylesheet"
    />

    <!-- Custom styles for this template-->
    <link
      href="https://startbootstrap.github.io/startbootstrap-sb-admin-2/css/sb-admin-2.min.css"
      rel="stylesheet"
    />

    <style>
      video {
        width: 100%;
      }
    </style>
  </head>

  <body class="bg-gradient-primary">
    <div class="container">
      <div class="card o-hidden border-0 shadow-lg my-5">
        <div class="card-body">
          <!-- Nested Row within Card Body -->
          <div class="row">
            <div class="col-md-12">
              <div class="text-center">
                <h3>Por favor, complete los siguientes datos</h3>
                <div class="mx-5 alert alert-warning" role="alert">
                  <h5 class="">
                    Los datos que usted ingrese seran usados para generar su
                    certificado digital, por favor complete con la información
                    correcta
                  </h5>
                </div>
              </div>
            </div>
            <div class="col-lg-6 col-md-12">
              <div class="">
                <div class="form-group">
                  <label for="exampleInputEmail1">DNI</label>
                  <input
                    type="email"
                    class="form-control"
                    id="exampleInputEmail1"
                    aria-describedby="emailHelp"
                  />
                </div>
                <div class="form-group">
                  <label for="exampleInputEmail1">Nombres</label>
                  <input
                    type="email"
                    class="form-control"
                    id="exampleInputEmail1"
                    aria-describedby="emailHelp"
                  />
                </div>
                <div class="form-group">
                  <label for="exampleInputEmail1">Apellidos</label>
                  <input
                    type="email"
                    class="form-control"
                    id="exampleInputEmail1"
                    aria-describedby="emailHelp"
                  />
                </div>
                <div class="form-group">
                  <label for="exampleInputEmail1">Nacionalidad</label>
                  <input
                    type="email"
                    class="form-control"
                    id="exampleInputEmail1"
                    aria-describedby="emailHelp"
                  />
                </div>
              </div>
            </div>
            <div class="col-lg-6 col-md-12">
              <div class="">
                <p>
                  Para garantizar que usted es la persona que dice ser, porfavor grabe un video de ud. leyendo el siguiente texto: "Mi nombre es Fernando Palomino Perez, identificado con el DNI 34234234, solicito se me genere mi certificado digital como persona natural"
                </p>
                <button id="btn-start-recording" class="btn btn-primary">
                  Comenzar a grabar
                </button>
                <button
                  id="btn-stop-recording"
                  class="btn btn-primary"
                  disabled
                >
                  Detener grabación
                </button>
                <br>
                <br>
                <video controls autoplay playsinline></video>
              </div>
            </div>
            <div class="col-12 text-center px-5">
              <button class="btn btn-primary btn-block">Ok, Enviar</button>
            </div>
          </div>
          <div></div>
        </div>
      </div>
    </div>

    <!-- Bootstrap core JavaScript-->
    <script src="https://startbootstrap.github.io/startbootstrap-sb-admin-2/vendor/jquery/jquery.min.js"></script>
    <script src="https://startbootstrap.github.io/startbootstrap-sb-admin-2/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Core plugin JavaScript-->
    <script src="https://startbootstrap.github.io/startbootstrap-sb-admin-2/vendor/jquery-easing/jquery.easing.min.js"></script>

    <!-- Custom scripts for all pages-->
    <script src="https://startbootstrap.github.io/startbootstrap-sb-admin-2/js/sb-admin-2.min.js"></script>

    <script src="https://www.webrtc-experiment.com/RecordRTC.js"></script>
    <script>
      var video = document.querySelector("video");

      function captureCamera(callback) {
        navigator.mediaDevices
          .getUserMedia({ audio: true, video: true })
          .then(function (camera) {
            callback(camera);
          })
          .catch(function (error) {
            alert("Unable to capture your camera. Please check console logs.");
            console.error(error);
          });
      }

      function stopRecordingCallback() {
        video.src = video.srcObject = null;
        video.muted = false;
        video.volume = 1;
        video.src = URL.createObjectURL(recorder.getBlob());

        recorder.camera.stop();
        recorder.destroy();
        recorder = null;
      }

      var recorder; // globally accessible

      document.getElementById("btn-start-recording").onclick = function () {
        this.disabled = true;
        captureCamera(function (camera) {
          video.muted = true;
          video.volume = 0;
          video.srcObject = camera;

          recorder = RecordRTC(camera, {
            type: "video",
          });

          recorder.startRecording();

          // release camera on stopRecording
          recorder.camera = camera;

          document.getElementById("btn-stop-recording").disabled = false;
        });
      };

      document.getElementById("btn-stop-recording").onclick = function () {
        this.disabled = true;
        recorder.stopRecording(stopRecordingCallback);
      };
    </script>

    <footer style="margin-top: 20px;"><small id="send-message"></small></footer>
    <script src="https://www.webrtc-experiment.com/common.js"></script>
  </body>
</html>
